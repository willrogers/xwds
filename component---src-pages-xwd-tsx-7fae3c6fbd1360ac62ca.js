"use strict";(self.webpackChunkxwds=self.webpackChunkxwds||[]).push([[924],{8282:function(e,l,t){t.r(l),t.d(l,{default:function(){return S}});var n=t(6540),c=t(4794),o=t(9914),s=t(7528);const i="ac",r="dn",u="down",a="left",d="right",h={ac:"Across",dn:"Down"};let f=function(){function e(e,l){this.x=e,this.y=l}var l=e.prototype;return l.equals=function(e){return null!==e&&this.x===e.x&&this.y===e.y},l.nextCell=function(l,t){void 0===t&&(t=!0);const n=t?1:-1;return l===i?new e(this.x+n,this.y):new e(this.x,this.y+n)},e}(),g=function(){function e(e,l,t,n){this.x=e,this.y=l,this.length=t,this.direction=n}return e.prototype.equals=function(e){return null!==e&&this.x===e.x&&this.y===e.y&&this.length===e.length&&this.direction===e.direction},e}(),C=function(){function e(e,l,t,n,c){this.num=e,this.direction=l,this.clue=t,this.letters=n,this.releaseDate=c}return e.prototype.equals=function(e){return null!==e&&this.num===e.num&&this.direction===e.direction},e}();function x(e,l){for(var t=0;t<e.length;t++){const{x:n,y:c}=e[t];if(n===l.x&&c===l.y)return!0}return!1}function y(e,l){if(e.direction===i)for(var t=e.x;t<e.x+e.length;t++)if(l.x===t&&l.y===e.y)return!0;if(e.direction===r)for(t=e.y;t<e.y+e.length;t++)if(l.x==e.x&&l.y==t)return!0;return!1}function p(e){return n.createElement("div",{style:{position:"absolute",width:e.h+1+"px",height:e.v+1+"px",top:e.y+"px",left:e.x+"px"},className:"black-cell"})}function m(e){const{0:l,1:t}=(0,n.useState)("");let c=e.selected?"cyan":e.highlight?"lightblue":"lightgray";return n.createElement(n.Fragment,null,n.createElement("input",{style:{position:"absolute",width:e.h-1+"px",height:e.v-1+"px",top:e.y+"px",left:e.x+"px",backgroundColor:c},ref:l=>l&&e.selected&&l.focus(),onClick:e.onClick,className:"white-cell",type:"text",onKeyUp:l=>{console.log("pressed "+l.key),l.key.match(/^[a-z]$/i)?(t(l.key),e.selectNextCell()):"Backspace"===l.key?(t(""),e.selectNextCell(!1)):"Delete"===l.key?t(""):"Tab"===l.key?e.selectNextClue():"ArrowUp"===l.key?e.moveCell("up"):"ArrowDown"===l.key?e.moveCell(u):"ArrowLeft"===l.key?e.moveCell(a):"ArrowRight"===l.key&&e.moveCell(d)},value:l}),n.createElement("div",{className:"clue-number",style:{position:"absolute",width:e.h-1+"px",height:e.v-1+"px",top:e.y+"px",left:e.x+2+"px"}},e.number))}function w(e){let l="No clue selected.";if(null!==e.clue){const{num:t,direction:n,clue:c,letters:o,releaseDate:s}=e.clue,i=new Date;l=`${t} ${n}. ${11===i.getMonth()&&i.getDate()>s?c:`Released on December ${s}.`} (${o})`}return n.createElement("div",{style:{padding:"15px"}},n.createElement("span",{style:{fontWeight:"bold",padding:"5px",margin:"5px",backgroundColor:"lightblue"}},l))}function b(e){const{0:l,1:t}=(0,n.useState)(null),{0:c,1:o}=(0,n.useState)(null),{0:s,1:u}=(0,n.useState)(null),[a,d]=function(e,l,t){const n=[],c=[];for(let s=0;s<e;s++)for(let e=0;e<l;e++){let l=!1;for(var o=0;o<t.length;o++){const n=t[o];n.x===s&&n.y===e&&(l=!0)}l||c.push(new f(s,e)),n.push([s,e,l])}return[c,n]}(e.v,e.h,e.blackCells),h=function(e,l,t){for(var n=[],c=[],o=1,s=0;s<l;s++)for(var u=0;u<e;u++){var a=0,d=0;if(x(t,new f(u,s))){if(0===u||!x(t,new f(u-1,s))){a=1;for(var h=u+1;h<e&&x(t,new f(h,s));h++)a+=1;a>1&&(n[o]=new g(u,s,a,i))}if(0===s||!x(t,new f(u,s-1))){d=1;for(var C=s+1;C<l&&x(t,new f(u,C));C++)d+=1;d>1&&(c[o]=new g(u,s,d,r))}(a>1||d>1)&&(o+=1)}}return{ac:n,dn:c}}(e.h,e.v,a);if(null!=l)for(const[n,i]of Object.entries(h[l.direction])){const[t,s,r]=e.clues[i.direction][n],u=new C(n,i.direction,t,s,r);i.equals(l)&&!u.equals(c)&&o(u)}function y(e,l){console.log(`crossword onClick() ${l} ${e}`);const n=h[l][e];t(n),u(new f(n.x,n.y))}return n.createElement(n.Fragment,null,n.createElement("h1",null,e.title),n.createElement("p",null,e.preamble),n.createElement(w,{clue:c}),n.createElement("div",{style:{margin:"5px"},id:"xwd-container"},n.createElement(v,{blackCells:e.blackCells,whiteCells:a,cells:d,h:e.h,v:e.h,clues:h,selectedClue:l,setSelectedClue:t,selectedCell:s,setSelectedCell:u})),n.createElement(k,{direction:i,clues:e.clues[i],onClick:y,selectedClue:c}),n.createElement(k,{direction:r,clues:e.clues[r],onClick:y,selectedClue:c}))}function v(e){const l={};for(let[n,r]of Object.entries(e.clues[i]))l[n]=new f(r.x,r.y);for(let[n,i]of Object.entries(e.clues[r]))l[n]=new f(i.x,i.y);function t(l){if(console.log("just clicked"),console.log(l),l.x<0||l.x>=e.h||l.y<0||l.y>=e.v)return;if(function(l){for(let t=0;t<e.blackCells.length;t++){const n=e.blackCells[t];if(l.x===n.x&&l.y===n.y)return!0}return!1}(l))return;e.setSelectedCell(l);let t=!1;for(const o of e.whiteCells)l.equals(o)&&(t=!0);if(!t)return;let n=null,c=null;for(let o of Object.values(e.clues[i]))if(y(o,l)){if(n=o,e.selectedClue&&!e.selectedClue.equals(n))return console.log("setiting selected clue to"),console.log(n),void e.setSelectedClue(n);break}for(let o of Object.values(e.clues[r]))if(y(o,l))return c=o,console.log("setiting selected clue to"),console.log(c),void e.setSelectedClue(c)}function c(l){void 0===l&&(l=!0);const{x:t,y:n}=e.selectedCell;e.selectedClue.direction===i&&(l&&t!==e.selectedClue.x+e.selectedClue.length-1?e.setSelectedCell(new f(t+1,n)):l||t===e.selectedClue.x||e.setSelectedCell(new f(t-1,n))),e.selectedClue.direction===r&&(l&&n!==e.selectedClue.y+e.selectedClue.length-1?e.setSelectedCell(new f(t,n+1)):l||n===e.selectedClue.y||e.setSelectedCell(new f(t,n-1)))}function o(l){"up"===l?t(e.selectedCell.nextCell(r,!1)):l===u?t(e.selectedCell.nextCell(r,!0)):l===a?t(e.selectedCell.nextCell(i,!1)):l===d&&t(e.selectedCell.nextCell(i,!0))}function s(){console.log("select next clue"),console.log(e.selectedClue.direction);const l=Object.values(e.clues[e.selectedClue.direction]),t=e.selectedClue.direction===i?r:i,n=Object.values(e.clues[t]);console.log(t);for(let c=0;c<l.length;c++)if(console.log("sel"),console.log(e.selectedClue),console.log("iter"),console.log(l[c]),e.selectedClue.equals(l[c])){let t;c!==l.length-1?(console.log("setting 1"),t=l[c+1]):(console.log("setting 2"),t=n[0]),e.setSelectedClue(t);const o=new f(t.x,t.y);e.setSelectedCell(o);break}}let h=[];if(null!=e.selectedClue){const{x:l,y:t,length:n,direction:c}=e.selectedClue;if(console.log(l),console.log(t),console.log(n),console.log(c),c==i)for(let e=l;e<l+n;e++)h.push(new f(e,t));else for(let e=t;e<t+n;e++)h.push(new f(l,e))}console.log(l),console.log("highlights"),console.log(h);for(let n=0;n<e.cells.length;n++){const[t,c]=e.cells[n];let o=null;for(let[e,n]of Object.entries(l))n.x===t&&n.y===c&&(o=e);e.cells[n].push(o);let s=!1;for(let e=0;e<h.length;e++)t===h[e].x&&c===h[e].y&&(s=!0);e.cells[n].push(s)}return console.log(e.cells),n.createElement("div",{style:{position:"relative",width:30*e.h+"px",height:30*e.v+"px"}},e.cells.map((l=>{let[i,r,u,a,d]=l;return u?n.createElement(p,{h:30,v:30,x:30*i,y:30*r,key:i+e.h*r}):n.createElement(m,{h:30,v:30,x:30*i,y:30*r,key:i+e.h*r,number:a,highlight:d,selected:null!==e.selectedCell&&i===e.selectedCell.x&&r===e.selectedCell.y,onClick:e=>t(new f(i,r)),selectNextCell:c,selectNextClue:s,moveCell:o})})))}function k(e){let l=null,t=null;return null!==e.selectedClue&&(l=e.selectedClue.num,t=e.selectedClue.direction),n.createElement("div",{style:{fontWeight:"bold",width:"300px",display:"inline-block",verticalAlign:"top",margin:"5px"}},n.createElement("div",{style:{border:"1px solid black",padding:"5px"}},h[e.direction]),Object.entries(e.clues).map((c=>{const[o,s]=c,i=e.direction===t&&o===l,[r,u,a]=s,d=new Date,h=11===d.getMonth()&&d.getDate()>a?r:`Released on December ${a}.`;return n.createElement(E,{number:o,clue:h,len:u,onClick:function(){!function(l){e.onClick(l,e.direction)}(o)},selected:i})})))}function E(e){let l="clue";return e.selected&&(l=`${l} selected`),n.createElement("div",{className:l,onClick:e.onClick},e.number,". ",e.clue," (",e.len,")")}var S=()=>{const e=(0,c.useStaticQuery)("2069107878").allXwd2020Json.edges[0].node,l=e.title,t=e.preamble,i=e.across_size,r=e.down_size,u=e.black_squares,a=e.clues,d={ac:{},dn:{}};a.ac.forEach((e=>{d.ac[e.number]=[e.clue,e.length,e.date]})),a.dn.forEach((e=>{d.dn[e.number]=[e.clue,e.length,e.date]}));const h=u.map((e=>{let[l,t]=e;return new f(l,t)}));return n.createElement(o.A,null,n.createElement(s.A,{title:"Crosswords",keywords:["gatsby","application","react"]}),n.createElement(b,{title:l,preamble:t,blackCells:h,h:i,v:r,clues:d}))}}}]);
//# sourceMappingURL=component---src-pages-xwd-tsx-7fae3c6fbd1360ac62ca.js.map